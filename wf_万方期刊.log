2018-11-09 00:25:02 [scrapy.utils.log] INFO: Scrapy 1.5.1 started (bot: wanfang_periodical)
2018-11-09 00:25:02 [scrapy.utils.log] INFO: Versions: lxml 4.2.1.0, libxml2 2.9.8, cssselect 1.0.3, parsel 1.5.0, w3lib 1.19.0, Twisted 18.7.0, Python 3.6.5 (v3.6.5:f59c0932b4, Mar 28 2018, 05:52:31) - [GCC 4.2.1 Compatible Apple LLVM 6.0 (clang-600.0.57)], pyOpenSSL 18.0.0 (OpenSSL 1.1.0h  27 Mar 2018), cryptography 2.2.2, Platform Darwin-17.7.0-x86_64-i386-64bit
2018-11-09 00:25:02 [scrapy.crawler] INFO: Overridden settings: {'BOT_NAME': 'wanfang_periodical', 'DOWNLOAD_DELAY': 0.5548149250049321, 'LOG_FILE': 'wf_万方期刊.log', 'LOG_LEVEL': 'INFO', 'NEWSPIDER_MODULE': 'wanfang_periodical.spiders', 'SPIDER_MODULES': ['wanfang_periodical.spiders']}
2018-11-09 00:25:02 [scrapy.middleware] INFO: Enabled extensions:
['scrapy.extensions.corestats.CoreStats',
 'scrapy.extensions.telnet.TelnetConsole',
 'scrapy.extensions.memusage.MemoryUsage',
 'scrapy.extensions.logstats.LogStats']
2018-11-09 00:25:03 [scrapy.middleware] INFO: Enabled downloader middlewares:
['scrapy.downloadermiddlewares.httpauth.HttpAuthMiddleware',
 'scrapy.downloadermiddlewares.downloadtimeout.DownloadTimeoutMiddleware',
 'scrapy.downloadermiddlewares.defaultheaders.DefaultHeadersMiddleware',
 'scrapy.downloadermiddlewares.useragent.UserAgentMiddleware',
 'wanfang_periodical.middlewares.RandomUserAgentMiddleware',
 'wanfang_periodical.middlewares.WanfangPeriodicalDownloaderMiddleware',
 'scrapy.downloadermiddlewares.retry.RetryMiddleware',
 'scrapy.downloadermiddlewares.redirect.MetaRefreshMiddleware',
 'scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware',
 'scrapy.downloadermiddlewares.redirect.RedirectMiddleware',
 'scrapy.downloadermiddlewares.cookies.CookiesMiddleware',
 'scrapy.downloadermiddlewares.httpproxy.HttpProxyMiddleware',
 'scrapy.downloadermiddlewares.stats.DownloaderStats']
2018-11-09 00:25:03 [scrapy.middleware] INFO: Enabled spider middlewares:
['scrapy.spidermiddlewares.httperror.HttpErrorMiddleware',
 'scrapy.spidermiddlewares.offsite.OffsiteMiddleware',
 'scrapy.spidermiddlewares.referer.RefererMiddleware',
 'scrapy.spidermiddlewares.urllength.UrlLengthMiddleware',
 'scrapy.spidermiddlewares.depth.DepthMiddleware']
2018-11-09 00:25:03 [scrapy.middleware] INFO: Enabled item pipelines:
['wanfang_periodical.pipelines.MongoproPipeline']
2018-11-09 00:25:03 [scrapy.core.engine] INFO: Spider opened
2018-11-09 00:25:03 [scrapy.extensions.logstats] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2018-11-09 00:25:03 [wf_period] INFO: Spider opened: wf_period
2018-11-09 00:25:08 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:25:11 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:25:14 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:25:20 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:25:25 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:25:30 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:25:33 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:25:38 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:25:43 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:25:48 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:25:53 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:25:56 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:26:00 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:26:04 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:26:08 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:26:12 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:26:16 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:26:20 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:26:20 [scrapy.extensions.logstats] INFO: Crawled 9 pages (at 9 pages/min), scraped 18 items (at 18 items/min)
2018-11-09 00:26:24 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:26:28 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:26:32 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:26:36 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:26:43 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:26:47 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:26:47 [scrapy.core.engine] INFO: Closing spider (finished)
2018-11-09 00:26:47 [scrapy.statscollectors] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 4258,
 'downloader/request_count': 9,
 'downloader/request_method_count/POST': 9,
 'downloader/response_bytes': 1174500,
 'downloader/response_count': 9,
 'downloader/response_status_count/200': 9,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2018, 11, 8, 16, 26, 47, 88438),
 'item_scraped_count': 24,
 'log_count/INFO': 33,
 'memusage/max': 66015232,
 'memusage/startup': 55619584,
 'request_depth_max': 1,
 'response_received_count': 9,
 'scheduler/dequeued': 9,
 'scheduler/dequeued/memory': 9,
 'scheduler/enqueued': 9,
 'scheduler/enqueued/memory': 9,
 'start_time': datetime.datetime(2018, 11, 8, 16, 25, 3, 468576)}
2018-11-09 00:26:47 [scrapy.core.engine] INFO: Spider closed (finished)
2018-11-09 00:33:20 [scrapy.utils.log] INFO: Scrapy 1.5.1 started (bot: wanfang_periodical)
2018-11-09 00:33:20 [scrapy.utils.log] INFO: Versions: lxml 4.2.1.0, libxml2 2.9.8, cssselect 1.0.3, parsel 1.5.0, w3lib 1.19.0, Twisted 18.7.0, Python 3.6.5 (v3.6.5:f59c0932b4, Mar 28 2018, 05:52:31) - [GCC 4.2.1 Compatible Apple LLVM 6.0 (clang-600.0.57)], pyOpenSSL 18.0.0 (OpenSSL 1.1.0h  27 Mar 2018), cryptography 2.2.2, Platform Darwin-17.7.0-x86_64-i386-64bit
2018-11-09 00:33:20 [scrapy.crawler] INFO: Overridden settings: {'BOT_NAME': 'wanfang_periodical', 'DOWNLOAD_DELAY': 0.6493055221674786, 'LOG_FILE': 'wf_万方期刊.log', 'LOG_LEVEL': 'INFO', 'NEWSPIDER_MODULE': 'wanfang_periodical.spiders', 'SPIDER_MODULES': ['wanfang_periodical.spiders']}
2018-11-09 00:33:20 [scrapy.middleware] INFO: Enabled extensions:
['scrapy.extensions.corestats.CoreStats',
 'scrapy.extensions.telnet.TelnetConsole',
 'scrapy.extensions.memusage.MemoryUsage',
 'scrapy.extensions.logstats.LogStats']
2018-11-09 00:33:20 [scrapy.middleware] INFO: Enabled downloader middlewares:
['scrapy.downloadermiddlewares.httpauth.HttpAuthMiddleware',
 'scrapy.downloadermiddlewares.downloadtimeout.DownloadTimeoutMiddleware',
 'scrapy.downloadermiddlewares.defaultheaders.DefaultHeadersMiddleware',
 'scrapy.downloadermiddlewares.useragent.UserAgentMiddleware',
 'wanfang_periodical.middlewares.RandomUserAgentMiddleware',
 'wanfang_periodical.middlewares.WanfangPeriodicalDownloaderMiddleware',
 'scrapy.downloadermiddlewares.retry.RetryMiddleware',
 'scrapy.downloadermiddlewares.redirect.MetaRefreshMiddleware',
 'scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware',
 'scrapy.downloadermiddlewares.redirect.RedirectMiddleware',
 'scrapy.downloadermiddlewares.cookies.CookiesMiddleware',
 'scrapy.downloadermiddlewares.httpproxy.HttpProxyMiddleware',
 'scrapy.downloadermiddlewares.stats.DownloaderStats']
2018-11-09 00:33:21 [scrapy.middleware] INFO: Enabled spider middlewares:
['scrapy.spidermiddlewares.httperror.HttpErrorMiddleware',
 'scrapy.spidermiddlewares.offsite.OffsiteMiddleware',
 'scrapy.spidermiddlewares.referer.RefererMiddleware',
 'scrapy.spidermiddlewares.urllength.UrlLengthMiddleware',
 'scrapy.spidermiddlewares.depth.DepthMiddleware']
2018-11-09 00:33:21 [scrapy.middleware] INFO: Enabled item pipelines:
['wanfang_periodical.pipelines.MongoproPipeline']
2018-11-09 00:33:21 [scrapy.core.engine] INFO: Spider opened
2018-11-09 00:33:21 [scrapy.extensions.logstats] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2018-11-09 00:33:21 [wf_period] INFO: Spider opened: wf_period
2018-11-09 00:33:26 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:32:25 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:32:28 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:32:35 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:32:41 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:32:45 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:32:55 [scrapy.crawler] INFO: Received SIGINT, shutting down gracefully. Send again to force 
2018-11-09 00:32:55 [scrapy.core.engine] INFO: Closing spider (shutdown)
2018-11-09 00:32:57 [scrapy.crawler] INFO: Received SIGINT twice, forcing unclean shutdown
2018-11-09 00:33:29 [scrapy.utils.log] INFO: Scrapy 1.5.1 started (bot: wanfang_periodical)
2018-11-09 00:33:29 [scrapy.utils.log] INFO: Versions: lxml 4.2.1.0, libxml2 2.9.8, cssselect 1.0.3, parsel 1.5.0, w3lib 1.19.0, Twisted 18.7.0, Python 3.6.5 (v3.6.5:f59c0932b4, Mar 28 2018, 05:52:31) - [GCC 4.2.1 Compatible Apple LLVM 6.0 (clang-600.0.57)], pyOpenSSL 18.0.0 (OpenSSL 1.1.0h  27 Mar 2018), cryptography 2.2.2, Platform Darwin-17.7.0-x86_64-i386-64bit
2018-11-09 00:33:29 [scrapy.crawler] INFO: Overridden settings: {'BOT_NAME': 'wanfang_periodical', 'DOWNLOAD_DELAY': 0.23293258731509373, 'LOG_FILE': 'wf_万方期刊.log', 'LOG_LEVEL': 'INFO', 'NEWSPIDER_MODULE': 'wanfang_periodical.spiders', 'SPIDER_MODULES': ['wanfang_periodical.spiders']}
2018-11-09 00:33:29 [scrapy.middleware] INFO: Enabled extensions:
['scrapy.extensions.corestats.CoreStats',
 'scrapy.extensions.telnet.TelnetConsole',
 'scrapy.extensions.memusage.MemoryUsage',
 'scrapy.extensions.logstats.LogStats']
2018-11-09 00:33:29 [scrapy.middleware] INFO: Enabled downloader middlewares:
['scrapy.downloadermiddlewares.httpauth.HttpAuthMiddleware',
 'scrapy.downloadermiddlewares.downloadtimeout.DownloadTimeoutMiddleware',
 'scrapy.downloadermiddlewares.defaultheaders.DefaultHeadersMiddleware',
 'scrapy.downloadermiddlewares.useragent.UserAgentMiddleware',
 'wanfang_periodical.middlewares.RandomUserAgentMiddleware',
 'wanfang_periodical.middlewares.WanfangPeriodicalDownloaderMiddleware',
 'scrapy.downloadermiddlewares.retry.RetryMiddleware',
 'scrapy.downloadermiddlewares.redirect.MetaRefreshMiddleware',
 'scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware',
 'scrapy.downloadermiddlewares.redirect.RedirectMiddleware',
 'scrapy.downloadermiddlewares.cookies.CookiesMiddleware',
 'scrapy.downloadermiddlewares.httpproxy.HttpProxyMiddleware',
 'scrapy.downloadermiddlewares.stats.DownloaderStats']
2018-11-09 00:33:29 [scrapy.middleware] INFO: Enabled spider middlewares:
['scrapy.spidermiddlewares.httperror.HttpErrorMiddleware',
 'scrapy.spidermiddlewares.offsite.OffsiteMiddleware',
 'scrapy.spidermiddlewares.referer.RefererMiddleware',
 'scrapy.spidermiddlewares.urllength.UrlLengthMiddleware',
 'scrapy.spidermiddlewares.depth.DepthMiddleware']
2018-11-09 00:33:29 [scrapy.middleware] INFO: Enabled item pipelines:
['wanfang_periodical.pipelines.MongoproPipeline']
2018-11-09 00:33:29 [scrapy.core.engine] INFO: Spider opened
2018-11-09 00:33:30 [scrapy.extensions.logstats] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2018-11-09 00:33:30 [wf_period] INFO: Spider opened: wf_period
2018-11-09 00:33:32 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 81, in parse_page
    item['affectoi'] = pageRow['affectoi']  # 影响因子
KeyError: 'affectoi'
2018-11-09 00:33:40 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:33:48 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:33:48 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:33:52 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:33:56 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:34:03 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:34:09 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:34:17 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:34:22 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:34:26 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:34:30 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:34:30 [scrapy.extensions.logstats] INFO: Crawled 4 pages (at 4 pages/min), scraped 10 items (at 10 items/min)
2018-11-09 00:34:33 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:34:36 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:34:40 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:34:43 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:34:43 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 81, in parse_page
    item['affectoi'] = pageRow['affectoi']  # 影响因子
KeyError: 'affectoi'
2018-11-09 00:34:51 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:34:57 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:35:02 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:35:02 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 76, in parse_page
    item['issn'] = pageRow['issn']  # 国际刊号
KeyError: 'issn'
2018-11-09 00:35:08 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:35:12 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:35:18 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:35:21 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:35:21 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:35:21 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:35:21 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 66, in parse_page
    if pageRow['hostunit_name']:
KeyError: 'hostunit_name'
2018-11-09 00:35:28 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:35:28 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:35:32 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:35:37 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:35:37 [scrapy.extensions.logstats] INFO: Crawled 11 pages (at 7 pages/min), scraped 24 items (at 14 items/min)
2018-11-09 00:35:40 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:35:40 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:35:44 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:35:47 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:35:50 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:35:50 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:35:55 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:35:59 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:36:02 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:36:06 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:36:10 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:36:14 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:36:17 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:36:20 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:36:26 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:36:31 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:36:31 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 76, in parse_page
    item['issn'] = pageRow['issn']  # 国际刊号
KeyError: 'issn'
2018-11-09 00:36:31 [scrapy.extensions.logstats] INFO: Crawled 15 pages (at 4 pages/min), scraped 38 items (at 14 items/min)
2018-11-09 00:36:34 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:36:34 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 77, in parse_page
    item['cn'] = pageRow['cn']  # 国内刊号
KeyError: 'cn'
2018-11-09 00:36:34 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:36:34 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 66, in parse_page
    if pageRow['hostunit_name']:
KeyError: 'hostunit_name'
2018-11-09 00:36:37 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 66, in parse_page
    if pageRow['hostunit_name']:
KeyError: 'hostunit_name'
2018-11-09 00:36:37 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 66, in parse_page
    if pageRow['hostunit_name']:
KeyError: 'hostunit_name'
2018-11-09 00:36:37 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 81, in parse_page
    item['affectoi'] = pageRow['affectoi']  # 影响因子
KeyError: 'affectoi'
2018-11-09 00:36:38 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:36:42 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 66, in parse_page
    if pageRow['hostunit_name']:
KeyError: 'hostunit_name'
2018-11-09 00:36:44 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:36:45 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:36:50 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:36:50 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:36:51 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:36:51 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:36:52 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:36:54 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:36:55 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:36:56 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 66, in parse_page
    if pageRow['hostunit_name']:
KeyError: 'hostunit_name'
2018-11-09 00:36:59 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:36:59 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:37:07 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:37:07 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:37:12 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:37:12 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:37:16 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:37:16 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:37:20 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:37:20 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:37:21 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:37:25 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:37:32 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:37:32 [scrapy.extensions.logstats] INFO: Crawled 37 pages (at 22 pages/min), scraped 46 items (at 8 items/min)
2018-11-09 00:37:32 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:37:36 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:37:39 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:37:43 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:37:47 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:37:47 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 90, in parse_page
    if pageRow['core_perio']:
KeyError: 'core_perio'
2018-11-09 00:37:47 [scrapy.core.scraper] ERROR: Spider error processing <POST http://www.wanfangdata.com.cn/perio/page.do> (referer: http://www.wanfangdata.com.cn)
Traceback (most recent call last):
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 30, in process_spider_output
    for x in result:
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/.virtualenvs/py3.6/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/xingwenhao/Desktop/wanfang_periodical/wanfang_periodical/spiders/wf_period.py", line 66, in parse_page
    if pageRow['hostunit_name']:
KeyError: 'hostunit_name'
2018-11-09 00:37:48 [scrapy.crawler] INFO: Received SIGINT, shutting down gracefully. Send again to force 
2018-11-09 00:37:48 [scrapy.crawler] INFO: Received SIGINT twice, forcing unclean shutdown
2018-11-09 00:37:50 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:37:50 [scrapy.core.engine] INFO: Closing spider (shutdown)
2018-11-09 00:37:55 [wf_period] INFO: 成功存入1条数据
2018-11-09 00:37:55 [scrapy.core.downloader.handlers.http11] WARNING: Got data loss in http://www.wanfangdata.com.cn/perio/page.do. If you want to process broken responses set the setting DOWNLOAD_FAIL_ON_DATALOSS = False -- This message won't be shown in further requests
2018-11-09 00:37:55 [scrapy.core.downloader.handlers.http11] WARNING: Got data loss in http://www.wanfangdata.com.cn/perio/page.do. If you want to process broken responses set the setting DOWNLOAD_FAIL_ON_DATALOSS = False -- This message won't be shown in further requests
2018-11-09 00:37:55 [scrapy.core.downloader.handlers.http11] WARNING: Got data loss in http://www.wanfangdata.com.cn/perio/page.do. If you want to process broken responses set the setting DOWNLOAD_FAIL_ON_DATALOSS = False -- This message won't be shown in further requests
2018-11-09 00:37:55 [scrapy.core.downloader.handlers.http11] WARNING: Got data loss in http://www.wanfangdata.com.cn/perio/page.do. If you want to process broken responses set the setting DOWNLOAD_FAIL_ON_DATALOSS = False -- This message won't be shown in further requests
2018-11-09 00:37:55 [scrapy.core.downloader.handlers.http11] WARNING: Got data loss in http://www.wanfangdata.com.cn/perio/page.do. If you want to process broken responses set the setting DOWNLOAD_FAIL_ON_DATALOSS = False -- This message won't be shown in further requests
2018-11-09 00:37:55 [scrapy.core.downloader.handlers.http11] WARNING: Got data loss in http://www.wanfangdata.com.cn/perio/page.do. If you want to process broken responses set the setting DOWNLOAD_FAIL_ON_DATALOSS = False -- This message won't be shown in further requests
2018-11-09 00:37:55 [scrapy.core.downloader.handlers.http11] WARNING: Got data loss in http://www.wanfangdata.com.cn/perio/page.do. If you want to process broken responses set the setting DOWNLOAD_FAIL_ON_DATALOSS = False -- This message won't be shown in further requests
2018-11-09 00:37:55 [scrapy.core.downloader.handlers.http11] WARNING: Got data loss in http://www.wanfangdata.com.cn/perio/page.do. If you want to process broken responses set the setting DOWNLOAD_FAIL_ON_DATALOSS = False -- This message won't be shown in further requests
